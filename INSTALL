
	INSTALL

	1. Download
	2. Preparation
	3. Installation
	3.1 Configure
	3.2 Compile & Cross compile
	3.3 Install
	4. Configuration
	4.1 Configure for one interface
	4.2 Configure for multi-interfaces on single host
	4.3 Configure for multi-hosts(just supported in Version 0.2.x or later):
	5. Access
	5.1 Access from web browser with web service
	5.2 vnstatgui: Access from web browser without web service
	6. More Configuration

---------

vnStatSVG is a SVG-based web frontend to vnStat(a traffic monitor in linux), so
you MUST install one of Linux distributions[1] and vnStat[2] at first.

now, it's time to show the basic steps to install vnStatSVG.

1. Download

vnStatSVG is released as vnstatsvg-X.Y.Z.tar.gz, 
you can DOWNLOAD the latest version from these links[3].

after downloading, you shoulw uncompress it

$ tar zxf vnstatsvg-<version>.tar.gz

let's overview the source code

$ tree src
src
├── admin
│   ├── index.xhtml
│   ├── index.xsl
│   ├── sidebar.xml
│   ├── sidebar.xml-template-4-multihosts
│   ├── sidebar.xml-template-4-singlehost
│   ├── sidebar.xsl
│   ├── vnstat.css
│   ├── vnstat.js
│   └── vnstat.xsl	# the XML interpreter file, with FULL comments
├── cgi-bin
│   ├── httpclient.c
│   ├── Makefile
│   ├── proxy.sh
│   ├── vnstat-c.sh
│   ├── vnstat-p.sh
│   ├── vnstat-shell.sh
│   ├── vnstatxml-1.6		# vnstat-1.6 with --dumpxml feature support
│   │   ├── README_vnStatXML
│   │   ├── src
│   │   │   ├── dumpxml.c
│   │   │   ├── dumpxml.h
│   │   │   └── vnstatxml.h
│   │   ├── UNINSTALL
│   │   └── UPGRADE
│   └── vnstatxml-standalone-1.6  # the standalone vnStatXML
│       ├── dbaccess.c
│       ├── dbaccess.h
│       ├── dumpxml.c
│       ├── dumpxml.h
│       ├── Makefile
│       ├── misc.c
│       ├── misc.h
│       ├── README
│       ├── vnstatxml.c
│       └── vnstatxml.h
└── vnstatgui			# SVG graphic output without web service
    ├── install.sh
    ├── README
    ├── uninstall.sh
    ├── vnstatgui.sh
    └── vnstat.xsl

2. Preparation

PLEASE forget the old versions, you'd better use the version >= 1.0.0 for the
old versions not support the following features:

	[*] multi-hosts
	
	the latest version can monitor different distributed
	servers in a "window"

	[*] multi-xml-dump-methods
	
	the latest version can dump the data collected by vnStat via at least
	three methods, one is the old method, via a shell script with the
	"--dumpdb" option provided by the original vnstat. another is a
	standalone vnStatXML program to dump XML from the database directly.
	the third method is patch vnStatXML to vnStat, and use the "--dumpxml"
	option to dump XML data directly.

	[*] Dynamic-monitor
	
	the latest version can give you a dynamical report about the memory,
	cpu and some other reltaive information in the future version.

before installing vnStatSVG, the following tools are needed.

	Tools		Requirement
	----------------------------------------------------------------------
	vnstat 		version >= 1.6
	httpd		support CGI in SHELL language
	sh		bash, dash, ash
	gawk/awk	only needed when using a shell script to dump xml data
	sort		
	cut		
	cron
	grep		

if you want to use the vnStatXML patch, you must download the source code of
vnStat, patch vnStatXML to it, and recompile, install it.

3. Installation

3.1 Configure

$ ./configure

by default, the cgi-bin directory will be set as /usr/lib/cgi-bin or /var/www
in order. the installation root directory will be set as /var/www, and the XML
dumping method via a shell script with "--dumpdb" option provided by vnStat
will be used.

if you want to do some special configuration, you can get help via the -h
option of configure.

3.2 Compile & Cross compile

$ make

To cross compile it for another architecture, use ARM as an example, please:

$ make CROSS_COMPILE=arm-linux-gnueabi-

To link statically, please:

$ make CFLAGS=" -static " CROSS_COMPILE=arm-linux-gnueabi-

Note: If don't want to compile vnstat separately, you can use the XML dumping
method patched vnstat. Although the latest vnstat itself provide the --xml
option, but our vnstatSVG doesn't work with the XML output for format issue.

3.3 Install

$ make install

4. Configuration

after installing vnStatSVG, we should do some configuration on it via modifying
the configuration file: /path/to/vnstatsvg-installation-root/sidebar.xml

4.1 Configure for one interface

<iface>
	 <name>the name of interface, such as eth0, eth1...</name>
	 <host>the ip address of domain of the host</host>
	 <dump_tool>the address of the cgi program, e.g. /cgi-bin/vnstat.sh</dump_tool>
	 <description>the description of this inteface, e.g. some description of iface</description>
</iface>

4.2 Configure for multi-interfaces on single host

just configure a new node named <iface> ... </iface> in.

4.3 Configure for multi-hosts

if you want to monitor server hosts in a "window", you just need to copy the
XML dumping reltated files to the relative servers. for example, if you use the
shell script with the "--dumpdb" option provided by vnStat to dump XML data,
      you just need to copy the vnstat-shell.sh to the server, of course gawk
      is needed to install there. if you use the vnStatXML to dump XML data
      directly, you should install vnStatXML and vnstat-c.sh there. if you want
      to patch vnStatXML to vnStat, you should recompile vnStat with the
      vnStatXML patch and copy the vnstat-c.sh there.

5. Access 

5.1 Access from web browser with web service

type the following link in your web browser:

http://host-ip-address/path/to/vnstatsvg-installation-root/index.xml

5.2 Access from web browser without web service

To get a graphic output without web serivce, you can simply use vnstatgui:

$ ./configure -m p
$ make; make install
$ pushd src/vnstatgui/
$ install.sh
$ vnstatgui
Usage: vnstatgui.sh -i iface -t [m|h|d|t|s]
                    m month
                    h hour
                    d day
                    t top10
                    s summary
$ ./vnstatgui.sh -i eth0 -t m

6. More configuration

in the latest version of vnStatSVG, it use index.xml as the index page, so,
   you'd better set index.xml as the index page via configuring the http
   server.

References & Links

[1] linux distributions list
http://www.linux.org/dist/
[2] vnStat
http://humdi.net/vnstat/
[3] download links
http://www.sourceforge.net/projects/vnstatsvg
http://www.tinylab.org/project/vnstatsvg/
[4] Demo links
http://tinylab.org/vnstatsvg
